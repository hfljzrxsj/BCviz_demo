import{j as e,r as U}from"./react-oik9md-E.js";import{i as q,U as F,f as Se,c as Q,T as xe,g as ge,p as Te,F as Ne,a as ke,L as $e,b as ee,d as te,h as Ve,u as we,w as se,e as ze,j as Ee,k as Be,l as Me,m as We,n as Oe,B as ae,S as Ae,C as He,s as Re}from"./main--irljbff.js";import{g as J,i as E,n as A,b as B,l as je,p as Ge,q as _e,k as Ke,r as Le}from"./ahooks-aQe87hPC.js";import{r as Ce}from"./react-dom-a-17rxNu.js";import{Q as qe}from"./react-toastify-5bXptfeX.js";import{w as L,a0 as Qe,a as z,I as be,a1 as Je,D as Y,P as y,O as Ye,Q as Xe,Y as ne,T as oe,B as M,a2 as Ze,a3 as et,a4 as ie,a5 as tt,a6 as st,a7 as at,a8 as nt,a9 as ot,aa as it,ab as K,l as rt,k as lt,ac as ct,ad as ut,ae as dt,F as mt}from"./@mui-jwcbe7e8.js";import{a as ve}from"./react-router-m2kkV1nU.js";import{u as X}from"./react-router-dom-OWcGx1G4.js";import"./@babel-_Kefij6Y.js";import"./react-fast-compare-751UTDWK.js";import"./echarts-Vo_PYHjZ.js";import"./zrender-6ibt0cUB.js";import"./@algolia-kof8UNv8.js";import"./scheduler-Xt5_ASe0.js";import"./tslib-xX1bOrSW.js";import"./lodash-C7I7b_wX.js";import"./react-transition-group-0QNSnBtb.js";import"./@emotion-ia0lOm4d.js";import"./hoist-non-react-statics-y4nWN7rF.js";import"./stylis-W9rcUKMO.js";import"./@popperjs-v-la0Vhf.js";import"./@remix-run-phvj9XUc.js";const ft="_Mid_1dd8c_1",ht={Mid:ft},pt="_Dialog_tm530_1",xt="_title_tm530_4",gt="_Paper_tm530_7",jt="_Tab_tm530_15",_t="_TabPanel_tm530_18",Ct="_input_tm530_28",w={Dialog:pt,title:xt,Paper:gt,Tab:jt,TabPanel:_t,input:Ct},bt=[{u:1,v:1},{u:1,v:2},{u:1,v:3},{u:1,v:4},{u:2,v:1},{u:2,v:2},{u:3,v:3},{u:3,v:4},{u:4,v:3},{u:4,v:4},{u:4,v:5},{u:5,v:5},{u:5,v:6},{u:6,v:5},{u:6,v:6},{u:7,v:7},{u:7,v:8},{u:8,v:7},{u:8,v:8}],vt={[F.U]:8,[F.V]:8},De=q?vt:{[F.U]:1,[F.V]:1},{isSafeInteger:re}=Number,Ue=(s,t)=>l=>{const{value:n}=l.target;if(n===""||_.isUndefined(n))s({[t]:void 0});else{const o=parseInt(n),c=Number(n);re(o)&&re(c)&&s({[t]:o})}},Z=Se[0],Pe=s=>t=>{s({[Z]:t},Q)},Dt=s=>{const{value:t,setUvCountInner:l,uv:n,resetUVCount:o}=s;if(!o)return null;const c=o[n];return e.jsx(Qe,{position:"end",title:`reset to ${c}`,children:e.jsx(z,{arrow:!0,title:`reset to ${c}`,placement:"right",children:e.jsx(be,{disabled:t===c,onClick:()=>{l({[n]:c})},edge:"end",size:"large",children:e.jsx(Je,{fontSize:"large"})})})})};function Ie(s){const{useUVCount:t,labelFunc:l,resetUVCount:n}=s,[o,c]=t;return H.map(m=>{const u=l(m),r=o[m];return e.jsx(L,{fullWidth:!0,label:u,title:u,placeholder:u,required:!0,spellCheck:!0,autoCapitalize:"on",enterKeyHint:"next",translate:"yes",error:!r,value:r,onChange:Ue(c,m),...xe,InputProps:{endAdornment:e.jsx(Dt,{uv:m,setUvCountInner:c,value:r,resetUVCount:n})}},m)})}const{isArray:Ut}=Array,Pt=99;function le(s){const t=_.clone(s[0]);if(!t)return null;for(const l of s)for(const n in l){const o=n,c=l[o];if(c>Pt)return null;c>t[o]&&(t[o]=c)}return t}const ce=_.mapValues(ke[0],(s,t)=>Ut(s)?[s[0],s[3]]:s);function It(s){const{useFileName:t,useUVCount:l,setGraghData:n}=s,[,o]=l,[c,{setTrue:m,setFalse:u}]=J(!1),[r,S]=E(q?2:0),[T,g]=t,p=A(De),[j,N]=p,[v,h]=E(),f=U.useMemo(()=>{switch(r){case 0:return H.some(a=>!j[a]);case 2:return!v}return!0},[r,j,v]),[k,I]=X(),$=B(({data:a,fileName:i})=>{const x=le(a);x&&(o(x),g(i),n(a),Pe(I)(i),u())}),d=B(()=>Ce.unstable_batchedUpdates(()=>{I(new URLSearchParams,Q),m()}));return U.useEffect(()=>{const a=k.get(Z);if(!a)return d();ge(a).then(i=>{if(!i)return d();const{fileData:x}=i;return $({fileName:a,data:Te(x)}),u()},i=>d())},[k]),e.jsx(Y,{open:c,className:w.Dialog??"",children:e.jsxs(y,{elevation:24,className:w.Paper??"",children:[e.jsxs(Ye,{value:r,children:[e.jsxs(Xe,{onChange:(a,i)=>S(i),children:[e.jsx(ne,{label:"Create New",value:0,className:w.Tab??""}),e.jsx(ne,{label:"From File",value:2,className:w.Tab??""})]}),e.jsx(oe,{value:0,children:e.jsx(y,{elevation:24,className:w.TabPanel??"",children:e.jsx(Ie,{useUVCount:p,labelFunc:a=>`Please enter count of ${a}`})})}),e.jsx(oe,{value:2,children:ce?e.jsx(Ne,{...ce,setWillPatchData:a=>{if(typeof a=="object"){const{data:i}=a;le(i)?h(a):alert("The dataset is too large!")}}}):null})]}),e.jsx(M,{fullWidth:!0,size:"large",disabled:f,variant:"contained",onClick:()=>{switch(r){case 0:{o(j);break}case 2:{v&&$(v);break}}u()},children:"Confirm"})]})})}const Ft="_Paper_109ek_1",yt={Paper:Ft};function St(s){const{useUVCount:t}=s,[l,n]=t,o=A(l),[c,m]=o;return je(()=>{m(l)},[l]),e.jsxs(y,{elevation:24,className:yt.Paper??"",children:[e.jsx(Ie,{useUVCount:o,labelFunc:u=>`Maximum Index of ${u}`,resetUVCount:l}),e.jsx(M,{fullWidth:!0,size:"large",disabled:H.some(u=>!c[u])||_.isEqual(l,c),variant:"contained",onClick:()=>{n(c)},children:"Modify"})]})}const Tt="_Paper_1pgn8_1",Nt={Paper:Tt},{abs:kt}=Math,ue=s=>`${s}.txt`,de=({fileNameBEWithExt:s,text:t})=>({fileInfo:{lastModified:Date.now(),name:s,size:t.length},fileData:t});function $t(s){const{text:t,fileName:l}=s,[n,{setTrue:o,setFalse:c}]=J(!1),m=ve(),[u,r]=A({s_min:1,t_min:1}),[S,T]=X(),[g,p]=E(""),j=B(async()=>{try{const h=ue(g),f=`${g}_cohesion${_.every(u,i=>i===1)?"":[u.s_min,u.t_min].map(i=>`_${i}`).join("")}.txt`,[k,I]=await Promise.all([h,f].map(Ve));if(k||await we(t,h),await se(),I||(await ze({dataset:h,...u}),await se()),!await ge(f).then(i=>i?.fileData)){qe.error(`construct ${f} is empty!`);return}const d=new URLSearchParams({dataset:h,BCviz_file:f});m({pathname:"/",search:`?${d.toString()}`});const a=de({fileNameBEWithExt:h,text:t});ee({...te,data:a,IDBValidKey:h})}catch{}}),{run:N,loading:v}=Ge(j,{...Ee,manual:!0});return e.jsxs(e.Fragment,{children:[e.jsx(Y,{open:n,onClose:()=>{c()},children:e.jsxs(y,{elevation:24,className:Nt.Paper??"",children:[e.jsx(L,{multiline:!0,maxRows:9,InputProps:{readOnly:!0},fullWidth:!0,label:"Text of bipartite graph",title:"Readonly TextArea",required:!0,translate:"yes",value:t}),_.map(u,(h,f)=>e.jsx(e.Fragment,{children:e.jsx(L,{fullWidth:!0,placeholder:f,label:f,...xe,title:f,value:h,onChange:Ue(r,f),required:!0,spellCheck:!0,autoCapitalize:"on",enterKeyHint:"next",translate:"yes",unselectable:"off"})})),e.jsx(M,{fullWidth:!0,variant:"contained",size:"large",disabled:_.some(u,_.isUndefined),onClick:N,children:"Confirm"})]})}),e.jsx($e,{open:v}),e.jsx(M,{fullWidth:!0,variant:"contained",size:"large",onClick:()=>Ce.unstable_batchedUpdates(()=>{const h=kt(CRC32.str(t)).toString(36);p(h);const f=ue(h);Pe(T)(f),o(),ee({...te,data:de({fileNameBEWithExt:f,text:t}),IDBValidKey:f})}),disabled:!t,children:"Next Step"})]})}const Vt="_title_kjfm3_1",wt={title:Vt},Fe="Usage Help";function zt({useDialogOpen:s}){const[t,{setTrue:l,setFalse:n}]=s;return e.jsx(e.Fragment,{children:e.jsxs(Y,{open:t,onClose:n,fullWidth:!0,autoFocus:!0,children:[e.jsx(Ze,{children:e.jsx("h1",{className:wt.title,children:Fe})}),e.jsx(et,{children:e.jsxs("ol",{children:[e.jsx("li",{children:e.jsx(ie,{children:e.jsx("p",{children:"Click vertices on U and V to create an edge between them."})})}),e.jsx("li",{children:e.jsx(ie,{children:e.jsx("p",{children:"Double-click an edge to delete it."})})})]})}),e.jsx(tt,{children:e.jsx(M,{size:"large",variant:"contained",fullWidth:!0,autoFocus:!0,onClick:n,startIcon:e.jsx(st,{fontSize:"large"}),children:"I Know"})})]})})}const Et="_absolute_1afwl_1",Bt={absolute:Et};function Mt(){const s=ve(),t=J(!1),[l,{setTrue:n}]=t,[o]=X(),c=_e(()=>o.has(Z),[o]),m=[at(),nt(),U.useId()];return e.jsxs(e.Fragment,{children:[e.jsxs(ot,{ariaLabel:"hjx",icon:e.jsx(it,{}),className:Bt.absolute??"",direction:"right",title:"Menu",children:[e.jsx(K,{icon:e.jsx(z,{title:"Back to previous page",arrow:!0,children:e.jsx(rt,{fontSize:"large"})}),onClick:()=>{s(-1)}},m[0]),e.jsx(K,{icon:e.jsx(z,{title:Fe,arrow:!0,children:e.jsx(lt,{fontSize:"large"})}),onClick:()=>{n()}},m[1]),c?e.jsx(K,{icon:e.jsx(z,{title:"Reload this page",arrow:!0,children:e.jsx(ct,{fontSize:"large"})}),onClick:()=>{s({},Q)}},m[2]):null]}),e.jsx(zt,{useDialogOpen:t})]})}const Wt="_box_f96qh_1",Ot={box:Wt},me=({onClick:s,isAbled:t,Icon:l})=>{const n=!t;return e.jsx(mt,{size:"large",onClick:s,disabled:n,title:"Undo",children:e.jsx(z,{title:"Undo",arrow:!0,placement:"right",children:e.jsx(be,{size:"large",disabled:n,color:t?"info":"default",children:e.jsx(l,{fontSize:"large",color:t?"primary":"disabled"})})})})};function At({graghDataHistoryTravel:{forward:s,forwardLength:t,back:l,backLength:n}}){return e.jsxs("div",{className:Ot.box,children:[e.jsx(me,{onClick:l,isAbled:!!n,Icon:ut},U.useId()),e.jsx(me,{onClick:s,isAbled:!!t,Icon:dt},U.useId())]})}const{freeze:Ht,fromEntries:fe}=Object,{from:Rt}=Array,{isSafeInteger:he}=Number,pe=`file-${new Date().toJSON()}`,H=Ht([F.U,F.V]),Gt=Le;function hs(){const s=E(pe),[t=pe,l]=s,n=A(De),[o,c]=n,m=Ke(o),u=Gt(q?bt:[{u:1,v:1}]),{value:r,setValue:S,reset:T}=u,g=U.useMemo(()=>{const d=_.flatMapDepth(o,(i,x)=>Rt(new Array(i)).map((C,P)=>({k:x,kInd:P+1})),1),a=Be(d,Re);return Me(d,[],a,innerHeight)},[o]);je(()=>{if(r&&_.some(o,(d,a)=>{if(_.isUndefined(d)||_.isUndefined(m))return!1;const i=m[a];return!_.isUndefined(i)&&d<i})){const d=r.filter(a=>_.every(a,(i,x)=>{const C=o[x];return!_.isUndefined(C)&&i<=C}));r.length>d.length&&T(d)}},[o]);const[p,j]=E(),N=U.useMemo(()=>_.isUndefined(p)?g:[...g.slice(0,p),{...g[p],color:We},...g.slice(p+1)],[p,g]),v=U.useMemo(()=>Oe({dataArrWithPos:N,graphData:r,emphasisFocus:"none"}),[N,r]),f=["click","series",B(d=>{if(!r)return;const{dataIndex:a,name:i,dataType:x}=d;if(he(a)&&i&&x==="node")if(_.isUndefined(p))j(a);else if(a===p)j(void 0);else{const C=g[a],P=g[p];if(!C||!P)return;const{k:R}=C,{k:G}=P;if(R===G)j(a);else{const W=[C,P];if(!r.find(b=>W.every(({k:D,kInd:V})=>b[D]===V))){const b=W.map(({k:V,kInd:ye})=>[V,ye]),D=fe(b);S(r.concat(D))}j(void 0)}}})],I=["dblclick","series",B(d=>{if(!r)return;const{dataIndex:a,name:i,data:x,dataType:C}=d,P=x;if(he(a)&&i&&C==="edge"){const{source:R,target:G}=P,W=fe([R,G].map(b=>{if(typeof b=="string"){const D=b[0],V=parseInt(b.slice(1));return[D,V]}return[]})),O=r.findIndex(b=>H.every(D=>b[D]===W[D]));O!==-1&&S([...r.slice(0,O),...r.slice(O+1)])}})],$=_e(()=>r?r.map(({u:d,v:a})=>`${d} ${a}`).join(`
`):"",[r]);return e.jsxs(y,{elevation:24,className:ae.Main??"",children:[e.jsx(It,{useFileName:s,useUVCount:n,setGraghData:T}),e.jsx(Ae,{isOpen:!1,children:e.jsx(St,{useUVCount:n})}),e.jsxs(y,{elevation:24,className:classNames(ae["Main-Mid"],ht.Mid),children:[e.jsx(He,{option:v,onParams:[I,f],style:{"--minHeight":"90vh"},isPermitShowLoading:!1}),e.jsx($t,{text:$,fileName:t})]}),e.jsx(At,{graghDataHistoryTravel:u}),e.jsx(Mt,{})]})}export{H as UVEnumArr,hs as default,Gt as useGraghDataHistoryTravel};
