import{j as e,r as P}from"./react-oik9md-E.js";import{i as L,U as F,f as Se,c as Q,T as ge,g as je,p as Te,F as Ne,a as $e,L as ke,b as te,d as se,h as Ve,u as we,w as ae,e as ze,j as Be,k as Ee,l as Me,m as We,n as Oe,B as ne,S as Ae,C as He,s as Re}from"./main-zkqkblCK.js";import{m as J,g as B,l as A,b as E,j as Y,p as Ge,q as _e,i as qe,r as Ke}from"./ahooks-VJayHAVi.js";import{r as Ce}from"./react-dom-a-17rxNu.js";import{Q as Le}from"./react-toastify-5bXptfeX.js";import{p as K,a0 as Qe,a as z,I as be,a1 as Je,q as X,P as y,O as Ye,Q as Xe,Y as oe,T as ie,B as M,a2 as Ze,a3 as et,a4 as re,a5 as tt,a6 as st,a7 as at,a8 as nt,a9 as ot,aa as it,ab as q,r as rt,G as lt,ac as ct,ad as ut,ae as dt,F as mt}from"./@mui-9txVA_s5.js";import{a as ve}from"./react-router-m2kkV1nU.js";import{u as Z}from"./react-router-dom-OWcGx1G4.js";import"./@babel-_Kefij6Y.js";import"./react-fast-compare-751UTDWK.js";import"./echarts-Vo_PYHjZ.js";import"./zrender-6ibt0cUB.js";import"./@algolia-kof8UNv8.js";import"./scheduler-Xt5_ASe0.js";import"./tslib-xX1bOrSW.js";import"./lodash-C7I7b_wX.js";import"./react-transition-group-0QNSnBtb.js";import"./@emotion-ia0lOm4d.js";import"./hoist-non-react-statics-y4nWN7rF.js";import"./stylis-W9rcUKMO.js";import"./@popperjs-v-la0Vhf.js";import"./@remix-run-phvj9XUc.js";const ft="_Mid_1dd8c_1",ht={Mid:ft},pt="_Dialog_tm530_1",xt="_title_tm530_4",gt="_Paper_tm530_7",jt="_Tab_tm530_15",_t="_TabPanel_tm530_18",Ct="_input_tm530_28",w={Dialog:pt,title:xt,Paper:gt,Tab:jt,TabPanel:_t,input:Ct},bt=[{u:1,v:1},{u:1,v:2},{u:1,v:3},{u:1,v:4},{u:2,v:1},{u:2,v:2},{u:3,v:3},{u:3,v:4},{u:4,v:3},{u:4,v:4},{u:4,v:5},{u:5,v:5},{u:5,v:6},{u:6,v:5},{u:6,v:6},{u:7,v:7},{u:7,v:8},{u:8,v:7},{u:8,v:8}],vt={[F.U]:8,[F.V]:8},Ue=L?vt:{[F.U]:1,[F.V]:1},{isSafeInteger:le}=Number,De=(s,t)=>l=>{const{value:n}=l.target;if(n===""||_.isUndefined(n))s({[t]:void 0});else{const o=parseInt(n),c=Number(n);le(o)&&le(c)&&s({[t]:o})}},ee=Se[0],Pe=s=>t=>{s({[ee]:t},Q)},Ut=s=>{const{value:t,setUvCountInner:l,uv:n,resetUVCount:o}=s;if(!o)return null;const c=o[n];return e.jsx(Qe,{position:"end",title:`reset to ${c}`,children:e.jsx(z,{arrow:!0,title:`reset to ${c}`,placement:"right",children:e.jsx(be,{disabled:t===c,onClick:()=>{l({[n]:c})},edge:"end",size:"large",children:e.jsx(Je,{fontSize:"large"})})})})};function Ie(s){const{useUVCount:t,labelFunc:l,resetUVCount:n}=s,[o,c]=t;return H.map(m=>{const u=l(m),r=o[m];return e.jsx(K,{fullWidth:!0,label:u,title:u,placeholder:u,required:!0,spellCheck:!0,autoCapitalize:"on",enterKeyHint:"next",translate:"yes",error:!r,value:r,onChange:De(c,m),...ge,InputProps:{endAdornment:e.jsx(Ut,{uv:m,setUvCountInner:c,value:r,resetUVCount:n})}},m)})}const{isArray:Dt}=Array,Pt=99;function ce(s){const t=_.clone(s[0]);if(!t)return null;for(const l of s)for(const n in l){const o=n,c=l[o];if(c>Pt)return null;c>t[o]&&(t[o]=c)}return t}const ue=_.mapValues($e[0],(s,t)=>Dt(s)?[s[0],s[3]]:s);function It(s){const{useFileName:t,useUVCount:l,setGraghData:n}=s,[,o]=l,[c,{setTrue:m,setFalse:u}]=J(!1),[r,S]=B(L?2:0),[T,g]=t,p=A(Ue),[j,N]=p,[v,h]=B(),f=P.useMemo(()=>{switch(r){case 0:return H.some(a=>!j[a]);case 2:return!v}return!0},[r,j,v]),[$,I]=Z(),k=E(({data:a,fileName:i})=>{const x=ce(a);x&&(o(x),g(i),n(a),Pe(I)(i),u())}),d=E(()=>Ce.unstable_batchedUpdates(()=>{I(new URLSearchParams,Q),m()}));return Y(()=>{const a=$.get(ee);if(!a)return d();je(a).then(i=>{if(!i)return d();const{fileData:x}=i;return k({fileName:a,data:Te(x)}),u()},i=>d())},[$]),e.jsx(X,{open:c,className:w.Dialog??"",children:e.jsxs(y,{elevation:24,className:w.Paper??"",children:[e.jsxs(Ye,{value:r,children:[e.jsxs(Xe,{onChange:(a,i)=>S(i),children:[e.jsx(oe,{label:"Create New",value:0,className:w.Tab??""}),e.jsx(oe,{label:"From File",value:2,className:w.Tab??""})]}),e.jsx(ie,{value:0,children:e.jsx(y,{elevation:24,className:w.TabPanel??"",children:e.jsx(Ie,{useUVCount:p,labelFunc:a=>`Please enter count of ${a}`})})}),e.jsx(ie,{value:2,children:ue?e.jsx(Ne,{...ue,setWillPatchData:a=>{if(typeof a=="object"){const{data:i}=a;ce(i)?h(a):alert("The dataset is too large!")}}}):null})]}),e.jsx(M,{fullWidth:!0,size:"large",disabled:f,variant:"contained",onClick:()=>{switch(r){case 0:{o(j);break}case 2:{v&&k(v);break}}u()},children:"Confirm"})]})})}const Ft="_Paper_109ek_1",yt={Paper:Ft};function St(s){const{useUVCount:t}=s,[l,n]=t,o=A(l),[c,m]=o;return Y(()=>{m(l)},[l]),e.jsxs(y,{elevation:24,className:yt.Paper??"",children:[e.jsx(Ie,{useUVCount:o,labelFunc:u=>`Maximum Index of ${u}`,resetUVCount:l}),e.jsx(M,{fullWidth:!0,size:"large",disabled:H.some(u=>!c[u])||_.isEqual(l,c),variant:"contained",onClick:()=>{n(c)},children:"Modify"})]})}const Tt="_Paper_1pgn8_1",Nt={Paper:Tt},{abs:$t}=Math,de=s=>`${s}.txt`,me=({fileNameBEWithExt:s,text:t})=>({fileInfo:{lastModified:Date.now(),name:s,size:t.length},fileData:t});function kt(s){const{text:t,fileName:l}=s,[n,{setTrue:o,setFalse:c}]=J(!1),m=ve(),[u,r]=A({s_min:1,t_min:1}),[S,T]=Z(),[g,p]=B(""),j=E(async()=>{try{const h=de(g),f=`${g}_cohesion${_.every(u,i=>i===1)?"":[u.s_min,u.t_min].map(i=>`_${i}`).join("")}.txt`,[$,I]=await Promise.all([h,f].map(Ve));if($||await we(t,h),await ae(),I||(await ze({dataset:h,...u}),await ae()),!await je(f).then(i=>i?.fileData)){Le.error(`construct ${f} is empty!`);return}const d=new URLSearchParams({dataset:h,BCviz_file:f});m({pathname:"/",search:`?${d.toString()}`});const a=me({fileNameBEWithExt:h,text:t});te({...se,data:a,IDBValidKey:h})}catch{}}),{run:N,loading:v}=Ge(j,{...Be,manual:!0});return e.jsxs(e.Fragment,{children:[e.jsx(X,{open:n,onClose:()=>{c()},children:e.jsxs(y,{elevation:24,className:Nt.Paper??"",children:[e.jsx(K,{multiline:!0,maxRows:9,InputProps:{readOnly:!0},fullWidth:!0,label:"Text of bipartite graph",title:"Readonly TextArea",required:!0,translate:"yes",value:t}),_.map(u,(h,f)=>e.jsx(e.Fragment,{children:e.jsx(K,{fullWidth:!0,placeholder:f,label:f,...ge,title:f,value:h,onChange:De(r,f),required:!0,spellCheck:!0,autoCapitalize:"on",enterKeyHint:"next",translate:"yes",unselectable:"off"})})),e.jsx(M,{fullWidth:!0,variant:"contained",size:"large",disabled:_.some(u,_.isUndefined),onClick:N,children:"Confirm"})]})}),e.jsx(ke,{open:v}),e.jsx(M,{fullWidth:!0,variant:"contained",size:"large",onClick:()=>Ce.unstable_batchedUpdates(()=>{const h=$t(CRC32.str(t)).toString(36);p(h);const f=de(h);Pe(T)(f),o(),te({...se,data:me({fileNameBEWithExt:f,text:t}),IDBValidKey:f})}),disabled:!t,children:"Next Step"})]})}const Vt="_title_kjfm3_1",wt={title:Vt},Fe="Usage Help";function zt({useDialogOpen:s}){const[t,{setTrue:l,setFalse:n}]=s;return e.jsx(e.Fragment,{children:e.jsxs(X,{open:t,onClose:n,fullWidth:!0,autoFocus:!0,children:[e.jsx(Ze,{children:e.jsx("h1",{className:wt.title,children:Fe})}),e.jsx(et,{children:e.jsxs("ol",{children:[e.jsx("li",{children:e.jsx(re,{children:e.jsx("p",{children:"Click vertices on U and V to create an edge between them."})})}),e.jsx("li",{children:e.jsx(re,{children:e.jsx("p",{children:"Double-click an edge to delete it."})})})]})}),e.jsx(tt,{children:e.jsx(M,{size:"large",variant:"contained",fullWidth:!0,autoFocus:!0,onClick:n,startIcon:e.jsx(st,{fontSize:"large"}),children:"I Know"})})]})})}const Bt="_absolute_1afwl_1",Et={absolute:Bt};function Mt(){const s=ve(),t=J(!1),[l,{setTrue:n}]=t,[o]=Z(),c=_e(()=>o.has(ee),[o]),m=[at(),nt(),P.useId()];return e.jsxs(e.Fragment,{children:[e.jsxs(ot,{ariaLabel:"hjx",icon:e.jsx(it,{}),className:Et.absolute??"",direction:"right",title:"Menu",children:[e.jsx(q,{icon:e.jsx(z,{title:"Back to previous page",arrow:!0,children:e.jsx(rt,{fontSize:"large"})}),onClick:()=>{s(-1)}},m[0]),e.jsx(q,{icon:e.jsx(z,{title:Fe,arrow:!0,children:e.jsx(lt,{fontSize:"large"})}),onClick:()=>{n()}},m[1]),c?e.jsx(q,{icon:e.jsx(z,{title:"Reload this page",arrow:!0,children:e.jsx(ct,{fontSize:"large"})}),onClick:()=>{s({},Q)}},m[2]):null]}),e.jsx(zt,{useDialogOpen:t})]})}const Wt="_box_f96qh_1",Ot={box:Wt},fe=({onClick:s,isAbled:t,Icon:l})=>{const n=!t;return e.jsx(mt,{size:"large",onClick:s,disabled:n,title:"Undo",children:e.jsx(z,{title:"Undo",arrow:!0,placement:"right",children:e.jsx(be,{size:"large",disabled:n,color:t?"info":"default",children:e.jsx(l,{fontSize:"large",color:t?"primary":"disabled"})})})})};function At({graghDataHistoryTravel:{forward:s,forwardLength:t,back:l,backLength:n}}){return e.jsxs("div",{className:Ot.box,children:[e.jsx(fe,{onClick:l,isAbled:!!n,Icon:ut},P.useId()),e.jsx(fe,{onClick:s,isAbled:!!t,Icon:dt},P.useId())]})}const{freeze:Ht,fromEntries:he}=Object,{from:Rt}=Array,{isSafeInteger:pe}=Number,xe=`file-${new Date().toJSON()}`,H=Ht([F.U,F.V]),Gt=Ke;function hs(){const s=B(xe),[t=xe,l]=s,n=A(Ue),[o,c]=n,m=qe(o),u=Gt(L?bt:[{u:1,v:1}]),{value:r,setValue:S,reset:T}=u,g=P.useMemo(()=>{const d=_.flatMapDepth(o,(i,x)=>Rt(new Array(i)).map((C,D)=>({k:x,kInd:D+1})),1),a=Ee(d,Re);return Me(d,[],a,innerHeight)},[o]);Y(()=>{if(r&&_.some(o,(d,a)=>{if(_.isUndefined(d)||_.isUndefined(m))return!1;const i=m[a];return!_.isUndefined(i)&&d<i})){const d=r.filter(a=>_.every(a,(i,x)=>{const C=o[x];return!_.isUndefined(C)&&i<=C}));r.length>d.length&&T(d)}},[o]);const[p,j]=B(),N=P.useMemo(()=>_.isUndefined(p)?g:[...g.slice(0,p),{...g[p],color:We},...g.slice(p+1)],[p,g]),v=P.useMemo(()=>Oe({dataArrWithPos:N,graphData:r,emphasisFocus:"none"}),[N,r]),f=["click","series",E(d=>{if(!r)return;const{dataIndex:a,name:i,dataType:x}=d;if(pe(a)&&i&&x==="node")if(_.isUndefined(p))j(a);else if(a===p)j(void 0);else{const C=g[a],D=g[p];if(!C||!D)return;const{k:R}=C,{k:G}=D;if(R===G)j(a);else{const W=[C,D];if(!r.find(b=>W.every(({k:U,kInd:V})=>b[U]===V))){const b=W.map(({k:V,kInd:ye})=>[V,ye]),U=he(b);S(r.concat(U))}j(void 0)}}})],I=["dblclick","series",E(d=>{if(!r)return;const{dataIndex:a,name:i,data:x,dataType:C}=d,D=x;if(pe(a)&&i&&C==="edge"){const{source:R,target:G}=D,W=he([R,G].map(b=>{if(typeof b=="string"){const U=b[0],V=parseInt(b.slice(1));return[U,V]}return[]})),O=r.findIndex(b=>H.every(U=>b[U]===W[U]));O!==-1&&S([...r.slice(0,O),...r.slice(O+1)])}})],k=_e(()=>r?r.map(({u:d,v:a})=>`${d} ${a}`).join(`
`):"",[r]);return e.jsxs(y,{elevation:24,className:ne.Main??"",children:[e.jsx(It,{useFileName:s,useUVCount:n,setGraghData:T}),e.jsx(Ae,{isOpen:!1,children:e.jsx(St,{useUVCount:n})}),e.jsxs(y,{elevation:24,className:classNames(ne["Main-Mid"],ht.Mid),children:[e.jsx(He,{option:v,onParams:[I,f],style:{"--minHeight":"90vh"},isPermitShowLoading:!1}),e.jsx(kt,{text:k,fileName:t})]}),e.jsx(At,{graghDataHistoryTravel:u}),e.jsx(Mt,{})]})}export{H as UVEnumArr,hs as default,Gt as useGraghDataHistoryTravel};
